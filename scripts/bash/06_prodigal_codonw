### @3rd silent codon position (codonw) 

#prokka tends to output incomplete .ffn files, which do not work for codonw
#use prodigal and filter for complete sequences

#run prodigal
for file in ../ncbi_dataset/data/*/*fna; do
  base=$(basename "$file" _genomic.fna);
  acc=$(echo "$base" | cut -d'.' -f1-2 | cut -d'.' -f1);
  prodigal -i "$file" -a "${acc}.faa" -d "${acc}_cds.ffn" -g 11 -c -m -f gff -o "${acc}_prodigal.gff"; #code 11 is bacterial/archaeal code
done


#install codonw
conda install -c bioconda codonw

#create directory
mkdir gc3_results

#run codonw
for file in ../prodigal_out/*ffn; do 
  base=$(basename "$file" .ffn)
  codonw "$file" -all_indices -nomenu
  mv "${base}.blk" "gc3_results/${base}_gc3.blk"; 
done
